<!doctype html><html lang=en-us><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=generator content="Wowchemy 5.2.0 for Hugo"><meta name=author content="Silas Kieser"><meta name=description content="Metagenomics has revoluzionized microbiology. This sequencing technology enables researchers to gain insight into the composition and functional potential of a microbial community in situ. Even though it is called metagenomics, the sequenced reads were not analyzed on a genome level due to technical limitations, especially the lack of reference genomes for many microbiomes."><link rel=alternate hreflang=en-us href=https://silask.github.io/post/better_genomes/><link rel=preconnect href=https://fonts.gstatic.com crossorigin><meta name=theme-color content="#1565c0"><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css integrity="sha256-FMvZuGapsJLjouA6k7Eo2lusoAX9i0ShlWFG6qt7SLc=" crossorigin=anonymous><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/github.min.css crossorigin=anonymous title=hl-light media=print onload='this.media="all"'><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/styles/dracula.min.css crossorigin=anonymous title=hl-dark media=print onload='this.media="all"' disabled><link rel=preload as=style href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap"><link rel=stylesheet href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700&family=Roboto+Mono&family=Roboto:wght@400;700&display=swap" media=print onload='this.media="all"'><link rel=stylesheet href=/css/wowchemy.e6f7b650e2d80724e28cce23c674926c.css><script async src="https://www.googletagmanager.com/gtag/js?id=UA-111618908-1"></script>
<script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}function trackOutboundLink(e,t){gtag("event","click",{event_category:"outbound",event_label:e,transport_type:"beacon",event_callback:function(){t!=="_blank"&&(document.location=e)}}),console.debug("Outbound link clicked: "+e)}function onClickCallback(e){if(e.target.tagName!=="A"||e.target.host===window.location.host)return;trackOutboundLink(e.target,e.target.getAttribute("target"))}gtag("js",new Date),gtag("config","UA-111618908-1",{}),gtag("set",{cookie_flags:"SameSite=None;Secure"}),document.addEventListener("click",onClickCallback,!1)</script><link rel=manifest href=/index.webmanifest><link rel=icon type=image/png href=/media/icon_hu0144edc3649b1995b32e914262035870_346211_32x32_fill_lanczos_center_3.png><link rel=apple-touch-icon type=image/png href=/media/icon_hu0144edc3649b1995b32e914262035870_346211_180x180_fill_lanczos_center_3.png><link rel=canonical href=https://silask.github.io/post/better_genomes/><meta property="twitter:card" content="summary_large_image"><meta property="og:site_name" content="Dr. Kieser"><meta property="og:url" content="https://silask.github.io/post/better_genomes/"><meta property="og:title" content="3 ways to improve genome catalogs | Dr. Kieser"><meta property="og:description" content="Metagenomics has revoluzionized microbiology. This sequencing technology enables researchers to gain insight into the composition and functional potential of a microbial community in situ. Even though it is called metagenomics, the sequenced reads were not analyzed on a genome level due to technical limitations, especially the lack of reference genomes for many microbiomes."><meta property="og:image" content="https://silask.github.io/post/better_genomes/featured.png"><meta property="twitter:image" content="https://silask.github.io/post/better_genomes/featured.png"><meta property="og:locale" content="en-us"><meta property="article:published_time" content="2022-04-12T00:24:00+01:00"><meta property="article:modified_time" content="2022-04-12T00:00:00+01:00"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://silask.github.io/post/better_genomes/"},"headline":"3 ways to improve genome catalogs","image":["https://silask.github.io/post/better_genomes/featured.png"],"datePublished":"2022-04-12T00:24:00+01:00","dateModified":"2022-04-12T00:00:00+01:00","author":{"@type":"Person","name":"Silas Kieser"},"publisher":{"@type":"Organization","name":"Dr. Kieser","logo":{"@type":"ImageObject","url":"https://silask.github.io/media/icon_hu0144edc3649b1995b32e914262035870_346211_192x192_fill_lanczos_center_3.png"}},"description":"Metagenomics has revoluzionized microbiology. This sequencing technology enables researchers to gain insight into the composition and functional potential of a microbial community in situ. Even though it is called metagenomics, the sequenced reads were not analyzed on a genome level due to technical limitations, especially the lack of reference genomes for many microbiomes."}</script><title>3 ways to improve genome catalogs | Dr. Kieser</title></head><body id=top data-spy=scroll data-offset=70 data-target=#TableOfContents class=page-wrapper data-wc-page-id=30a798c4de50547861e9c9e126f1d71c><script src=/js/wowchemy-init.min.5c87d484a568cb9870aa36d295c02167.js></script><aside class=search-modal id=search><div class=container><section class=search-header><div class="row no-gutters justify-content-between mb-3"><div class=col-6><h1>Search</h1></div><div class="col-6 col-search-close"><a class=js-search href=# aria-label=Close><i class="fas fa-times-circle text-muted" aria-hidden=true></i></a></div></div><div id=search-box><input name=q id=search-query placeholder=Search... autocapitalize=off autocomplete=off autocorrect=off spellcheck=false type=search class=form-control aria-label=Search...></div></section><section class=section-search-results><div id=search-hits></div></section></div></aside><div class=page-header><nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id=navbar-main><div class=container-xl><div class="d-none d-lg-inline-flex"><a class=navbar-brand href=/>Dr. Kieser</a></div><button type=button class=navbar-toggler data-toggle=collapse data-target=#navbar-content aria-controls=navbar-content aria-expanded=false aria-label="Toggle navigation">
<span><i class="fas fa-bars"></i></span></button><div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none"><a class=navbar-brand href=/>Dr. Kieser</a></div><div class="navbar-collapse main-menu-item collapse justify-content-start" id=navbar-content><ul class="navbar-nav d-md-inline-flex"><li class=nav-item><a class=nav-link href=/#about><span>Home</span></a></li><li class=nav-item><a class=nav-link href=/#posts><span>Posts</span></a></li><li class=nav-item><a class=nav-link href=/#featured><span>Publications</span></a></li><li class=nav-item><a class=nav-link href=/#contact><span>Contact</span></a></li></ul></div><ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2"><li class=nav-item><a class="nav-link js-search" href=# aria-label=Search><i class="fas fa-search" aria-hidden=true></i></a></li></ul></div></nav></div><div class=page-body><article class=article><div class="article-container pt-3"><h1>3 ways to improve genome catalogs</h1><div class=article-metadata><span class=article-date>Last updated on
12. Apr 2022</span></div></div><div class="article-header article-container featured-image-wrapper mt-4 mb-4" style=max-width:720px;max-height:540px><div style=position:relative><img src=/post/better_genomes/featured_huf6e69e06e7d3b2fae680a9a72cfcf02f_198010_720x0_resize_lanczos_3.png alt class=featured-image></div></div><div class=article-container><div class=article-style><p>Metagenomics has revoluzionized microbiology. This sequencing technology enables researchers to gain insight into the composition and functional potential of a microbial community <em>in situ</em>. Even though it is called meta<strong>genomics</strong>, the sequenced reads were not analyzed on a genome level due to technical limitations, especially the lack of reference genomes for many microbiomes.</p><p>In 2017, Parks <em>et al.</em> published nearly 8,000 metagenome-assembled genomes (MAGs), which substantially expanded the tree of life (Parks <em>et al.</em> 2017). Since then, we have entered an <strong>era of large-scale (re-)assembly in metagenomics</strong>. Many researchers started to assemble MAGs from various metagenomes, often recovering dozens of new species.
2017 also marks the year of the beginning of my PhD. So I had the opportunity to do my PhD during this exciting time. I worked mainly on <a href=/publication/atlas/>a pipline</a> that allows producing such MAG catalogs with only three commands. We applied our pipeline to all the samples from the mouse genome in order to recover a <a href=/publication/cmmg/>comprehensive catalog of genomes for this microbiome</a>.</p><p>With this study now published, I reflect on what can be improved for the benefit of others that take the challenge to create comprehensive catalogs for their microbiome of interest.</p><h1 id=1-use-co-binning>1. Use co-binning</h1><p>Most studies use single-sample assembly and binning because it allows the processing of each sample in parallel, making the approach very scalable. The downside of this approach is that the coverage information from only one sample is used. But using the <em>differenctial coverage</em> from multiple samples can be very useful for binning. There are alternatives, co-assembly, and cross-mapping, which allow for the use of differential abundance, but they have their problems and challenges <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>.</p><p>Recently, a new strategy for binning was developed, which I call <em>Co-Binning</em><sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>. The method works as follows:</p><ol><li>Assemble each sample separately</li><li>Concatenate the assembly of all samples to one</li><li>Map the reads from all samples to the concatenated assembly</li><li>Bin the contigs from each sample separately, but use the differential abundance from all samples.</li></ol><p>This strategy more or less combines the advantages of the other binning strategy. It doesn&rsquo;t require co-assembly and allows for the use of differential abundance and scales to many samples (~100). This strategy is implemented in the two tools <a href=https://doi.org/10.1038/s41587-020-00777-4 target=_blank rel=noopener><em>Vamb</em></a> and <a href=https://doi.org/10.1038/s41587-020-00777-4 target=_blank rel=noopener><em>SemiBin</em></a>. The authors of Vamb also claim that it can disentangle genomes from different subspecies up to 97% ANI, which I find pretty interesting. SemiBin uses not only the abundance but also the taxonomic annotation. Both binners could, in theory, also be used for Eukaryote binning. The only adaptation to SemiBin would be to use a taxonomic annotation that includes Eukaryotes.</p><p>So, If you plan to recover many genomes from metagenomes, think about trying out these new binners. I already implemented both binners in <a href=/publication/atlas/>metagenome-atlas</a>.</p><h1 id=2-optimize-quality-estimation>2. Optimize quality estimation</h1><p>The second step comes after realizing that the MAGs are not as good as we think &ndash; even the &lsquo;high-quality&rsquo;. The part has to do with the fact that MAGs are just of lousy quality due to limitations of the computational pipelines. Manual curation is needed (Chen <em>et al.</em> 2020).
But part has to do with the quality estimators telling us they are of good quality when reality, they are not.</p><h2 id=use-up-to-date-databases-for-genome-evaluation>Use up-to-date databases for genome evaluation</h2><p>The whole field uses checkM, which is an elegant tool. However, its database was not updated since 2015! Everybody is waiting for version 2 of the tool, but in the meantime, one can <em>use BUSCO</em> which works similarly, is based on the up-to-date OrthoDB markers, and works for eukaryotes.</p><h2 id=dont-automatically-select-marker-gene>Don&rsquo;t automatically select marker-gene</h2><p>CheckM and BUSCO automatically select the most appropriate marker gene set for evaluation, which is very handy, but it might also bias the results. For example, a genome is incomplete. Its taxonomic lineage cannot be determined, which causes it to be evaluated at the most basic level. If by chance, it contains many of the basic marker genes, which often cluster together in operons, it&rsquo;s estimated as highly complete.</p><p>If the genome in question is from a completely new species, there is no way to circumvent this, and it&rsquo;s good that the more unknown genomes are evaluated at more basic levels. However, if the genome belongs to an abundant species, you likely have hundreds of other genomes from the same species (in a radius of 95% ANI). In the worst case, a bad genome evaluated at the most basic level could be estimated to have better quality than other genomes evaluated with the more extended marker gene sets.</p><p>If you have multiple genomes of the same species, which you have if you create a genome collection, you want them to be all evaluated with the same marker gene set. Together with Matija Trikovic, we made <a href=https://github.com/trajkovski-lab/Quality-filtering target=_blank rel=noopener>a snakemake pipeline</a> that does exactly this.</p><p>We re-analyzed genomes from the UHGG and HumGut databases with BUSCO and the same set for each genome. What was estimated by CheckM to be 99% complete came out to less than 50% for some genomes! Which is due to both effects. 1. BUSCO has a more up-to-date database, and 2. We evaluated genomes from the same species cluster not automatically but with the same marker genes as the representative.</p><figure id=figure-completeness><div class="d-flex justify-content-center"><div class=w-100><img alt="Completeness estimatd for all MAGs in the HumGut catalog. The x-axis shows the completeness estimated with CheckM in auto-lineage mode. The y-axis shows the Completeness estimated using BUSCO with the same marker genes for each species." srcset="/post/better_genomes/Completeness_hudf64d9dd068e918caed1e5d32d238dbb_329614_69d1977d548fa2ad28d07cfaa834d079.png 400w,
/post/better_genomes/Completeness_hudf64d9dd068e918caed1e5d32d238dbb_329614_c6be5ea9a383d926da7265cf9474667f.png 760w,
/post/better_genomes/Completeness_hudf64d9dd068e918caed1e5d32d238dbb_329614_1200x1200_fit_lanczos_3.png 1200w" src=/post/better_genomes/Completeness_hudf64d9dd068e918caed1e5d32d238dbb_329614_69d1977d548fa2ad28d07cfaa834d079.png width=760 height=755 loading=lazy data-zoomable></div></div><figcaption>Completeness estimatd for all MAGs in the HumGut catalog. The x-axis shows the completeness estimated with CheckM in auto-lineage mode. The y-axis shows the Completeness estimated using BUSCO with the same marker genes for each species.</figcaption></figure><h2 id=ad-hoc-quality-estimation>Ad-hoc quality estimation</h2><p>This point is more an idea than concrete advice. If you have many genomes from the same species (or higher taxonomic clade) from a specific environment, then per definition, you would have the best collection of genomes to evaluate the completeness. You could define an ad-hoc set of marker genes, e.g., genes at 95% identity present in >90% of the genomes. Then you turn it around and ask how many genomes have >90% of these genes. It helps to refine completeness for a given species.</p><h1 id=2-filter-chimeric-genomes>2. Filter chimeric genomes</h1><p>The ad-hoc quality estimation doesn&rsquo;t help with contamination. But recently, new tools came out that check if genomes are chimeric — for example, <a href=https://genomebiology.biomedcentral.com/articles/10.1186/s13059-021-02393-0 target=_blank rel=noopener>GUNC</a> or <a href=https://github.com/dib-lab/charcoal target=_blank rel=noopener>Charcoal</a>. Taxonomically annotating contigs allows identifying contigs with incongruent taxonomy, aka chimera. This strategy is reference-based, but it provides filtering with a much broader scope than only looking at the marker genes.</p><p>Finally, with more and more genome catalogs out there, I think the question becomes more crucial about efficiently using them. We choose <strong>1</strong> genome per species as a reference, which we use to map reads against it or build a Kraken DB. This approach glosses over much of the strain variation already contained in the genome collections. In some publications, the authors make Kraken DBS with many genomes per species, which increases the mapping rate overall, but when estimated on the species level, it&rsquo;s lower (Nasko <em>et al.</em> 2018).</p><p>I could write more, but I leave it there for my first blog on metagenomics. Please reply to the Tweet below or mail me if you have comments and discussions.</p><blockquote class=twitter-tweet><p lang=en dir=ltr>My first blog post about ways to improve current genomes catalogs for metagenomics <a href=https://t.co/bBtM2DbUms>https://t.co/bBtM2DbUms</a></p>&mdash; Dr. Silas Kieser @silask@mstdn.science (@SilasKieser) <a href="https://twitter.com/SilasKieser/status/1513809109686042628?ref_src=twsrc%5Etfw">April 12, 2022</a></blockquote><script async src=https://platform.twitter.com/widgets.js></script><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>For a more detailed informations on the different binning aproaches see <a href=/post/phd-thesis/>my thesis</a> p.14, and <a href=/talk/3-day-course-on-metagenome-atlas/>my course</a>.&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>The approach is called <em>multisplit</em> in the publication of Vamb.&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><div class=share-box aria-hidden=true><ul class=share><li><a href="https://twitter.com/intent/tweet?url=https://silask.github.io/post/better_genomes/&amp;text=3%20ways%20to%20improve%20genome%20catalogs" target=_blank rel=noopener class=share-btn-twitter><i class="fab fa-twitter"></i></a></li><li><a href="https://www.facebook.com/sharer.php?u=https://silask.github.io/post/better_genomes/&amp;t=3%20ways%20to%20improve%20genome%20catalogs" target=_blank rel=noopener class=share-btn-facebook><i class="fab fa-facebook"></i></a></li><li><a href="mailto:?subject=3%20ways%20to%20improve%20genome%20catalogs&amp;body=https://silask.github.io/post/better_genomes/" target=_blank rel=noopener class=share-btn-email><i class="fas fa-envelope"></i></a></li><li><a href="https://www.linkedin.com/shareArticle?url=https://silask.github.io/post/better_genomes/&amp;title=3%20ways%20to%20improve%20genome%20catalogs" target=_blank rel=noopener class=share-btn-linkedin><i class="fab fa-linkedin-in"></i></a></li></ul></div><div class="media author-card content-widget-hr"><a href=https://silask.github.io/><img class="avatar mr-3 avatar-circle" src="https://s.gravatar.com/avatar/591119f511660dde907dfd01eefeba71?s=200" alt="Silas Kieser"></a><div class=media-body><h5 class=card-title><a href=https://silask.github.io/>Silas Kieser</a></h5><h6 class=card-subtitle>Metagenome researcher</h6><p class=card-text>Husband, Father & Metagenome researcher</p><ul class=network-icon aria-hidden=true><li><a href=mailto:silas.kieser@unige.ch><i class="fas fa-envelope"></i></a></li><li><a href=https://twitter.com/SilasKieser target=_blank rel=noopener><i class="fab fa-twitter"></i></a></li><li><a href=https://github.com/silask target=_blank rel=noopener><i class="fab fa-github"></i></a></li><li><a href="https://scholar.google.ch/citations?user=73hLKTUAAAAJ" target=_blank rel=noopener><i class="ai ai-google-scholar"></i></a></li></ul></div></div></div></article></div><div class=page-footer><div class=container><footer class=site-footer><p class=powered-by>© 2023 Silas Kieser</p><p class=powered-by>Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target=_blank rel=noopener>Wowchemy</a> — the free, <a href=https://github.com/wowchemy/wowchemy-hugo-modules target=_blank rel=noopener>open source</a> website builder that empowers creators.</p></footer></div></div><div id=modal class="modal fade" role=dialog><div class=modal-dialog><div class=modal-content><div class=modal-header><h5 class=modal-title>Cite</h5><button type=button class=close data-dismiss=modal aria-label=Close>
<span aria-hidden=true>&#215;</span></button></div><div class=modal-body><pre><code class="tex hljs"></code></pre></div><div class=modal-footer><a class="btn btn-outline-primary my-1 js-copy-cite" href=# target=_blank><i class="fas fa-copy"></i> Copy</a>
<a class="btn btn-outline-primary my-1 js-download-cite" href=# target=_blank><i class="fas fa-download"></i> Download</a><div id=modal-error></div></div></div></div></div><script src=https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/instant.page/5.1.0/instantpage.min.js integrity="sha512-1+qUtKoh9XZW7j+6LhRMAyOrgSQKenQ4mluTR+cvxXjP1Z54RxZuzstR/H9kgPXQsVB8IW7DMDFUJpzLjvhGSQ==" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.imagesloaded/4.1.4/imagesloaded.pkgd.min.js integrity="sha256-lqvxZrPLtfffUl2G/e7szqSvPBILGbwmsGE1MKlOi0Q=" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/jquery.isotope/3.0.6/isotope.pkgd.min.js integrity="sha256-CBrpuqrMhXwcLLUd5tvQ4euBHCdh7wGlDfNz8vbu/iI=" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/highlight.min.js integrity="sha512-TDKKr+IvoqZnPzc3l35hdjpHD0m+b2EC2SrLEgKDRWpxf2rFCxemkgvJ5kfU48ip+Y+m2XVKyOCD85ybtlZDmw==" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.2.0/languages/r.min.js></script>
<script id=search-hit-fuse-template type=text/x-template>
        <div class="search-hit" id="summary-{{key}}">
          <div class="search-hit-content">
            <div class="search-hit-name">
              <a href="{{relpermalink}}">{{title}}</a>
              <div class="article-metadata search-hit-type">{{type}}</div>
              <p class="search-hit-description">{{snippet}}</p>
            </div>
          </div>
        </div>
      </script><script src=https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.2.1/fuse.min.js integrity="sha256-VzgmKYmhsGNNN4Ph1kMW+BjoYJM2jV5i4IlFoeZA9XI=" crossorigin=anonymous></script>
<script src=https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin=anonymous></script>
<script src=/js/bootstrap.bundle.min.6aed84840afc03ab4d5750157f69c120.js></script>
<script src=/en/js/wowchemy.min.26bc5a5b73c468c9e767656a378ac5e3.js></script></body></html>